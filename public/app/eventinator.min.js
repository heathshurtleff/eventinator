angular.module("eventinator",["ui.router","ngResource"]);angular.module("eventinator").config(["$stateProvider","$urlRouterProvider",function(e,r){r.otherwise("/");e.state("main",{url:"/",templateUrl:"app/main/eventList.html"}).state("signup",{url:"/signup",templateUrl:"app/signup/eventSignup.html",controller:"eventSignupCtrl"})}]);angular.module("eventinator").controller("eventinatorCtrl",["$scope","eventIdentity","authService","$location",function(e,r,a,n){e.identity=r;e.signout=function(){a.logoutUser().then(function(){e.emial="";e.password="";n.path("/")})}}]);angular.module("eventinator").factory("authService",["$q","$http","eventUser","eventIdentity",function(e,r,a,n){return{createEvtUser:function(r){var t=new a(r),o=e.defer();t.$save().then(function(){n.currentUser=t;o.resolve()},function(e){o.reject(e.data.reason)});return o.promise},logoutUser:function(){var a=e.defer();r.post("/app/logout",{logout:!0}).then(function(){n.currentUser=void 0;a.resolve()});return a.promise}}}]);angular.module("eventinator").factory("eventIdentity",["$window","eventUser",function(e,r){var a;if(e.bootstrappedEventUser){a=new r;angular.extend(a,e.bootstrappedEventUser)}return{currentUser:a,authenticated:function(){return!!this.currentUser}}}]);angular.module("eventinator").controller("eventSignupCtrl",["$scope","$location","eventUser","authService",function(e,r,a,n){function t(e){var r=e.val(),a={upper:r.search(/[A-Z]/g)>-1,lower:r.search(/[a-z]/g)>-1,num:r.search(/[0-9]/g)>-1,punct:r.search(/[!#$@_'+,?\[\].-]/g)>-1,chars:r.length>=8,invalidChars:r.search(/[^A-z0-9\!\@\#\$\%\^\&\*]/g)>-1};o(a,e)}function o(e,r){var a=$(".pass-confirm-container"),n=a.find(".requirement-box"),t=$(".pwd-popover").find(".arrow"),o=!1;n.removeClass("valid");t.removeClass("valid");e.upper&&a.find(".upper").addClass("valid");e.lower&&a.find(".lower").addClass("valid");if(e.num){a.find(".num").addClass("valid");t.addClass("valid")}e.punct&&a.find(".punct").addClass("valid");e.chars&&a.find(".chars").addClass("valid");e.upper&&e.lower&&e.num&&e.punct&&e.chars||(o=!0);if(e.invalidChars){o=!0;$(".password-error").text("The password you entered contains an invalid character.")}else $(".password-error").text("");i(r,o)}function s(e,r){var a=e.data("bs.popover");a.tip().find(".popover-content").text(r)}function i(r,a){var n=r.parents(".has-feedback"),t=n.find(".form-control-feedback");if(a){e.validForm=!1;n.removeClass("has-success");t.removeClass("glyphicon-ok");n.addClass("has-error");t.addClass("glyphicon-remove")}else{e.validForm=!0;n.removeClass("has-error");t.removeClass("glyphicon-remove");n.addClass("has-success");t.addClass("glyphicon-ok")}}e.validForm=!0;e.eventSignup=function(){({email:e.email,password:e.password,fullName:e.fullName,company:e.company,job:e.job,bday:e.bday,homeAddress:e.homeAddress})};var d=$('#eventSignUpForm input[id!="password"]'),l=$("#password"),u=$("#confPass");l.popover({container:"body",content:'<div class="pass-confirm-container"><div class="requirement-box upper">A</div><div class="requirement-box lower">a</div><div class="requirement-box num">0-9</div><div class="requirement-box punct">!&amp;?</div><div class="requirement-box chars">8+</div></div>',html:!0,placement:"top",trigger:"focus",template:'<div class="popover pwd-popover"><div class="arrow"></div><div class="popover-content"></div></div>'});u.popover({container:"body",content:"Confirm your password",html:!0,placement:"top",trigger:"focus"});$(function(){$("[data-toggle=popover]").popover()});d.on("keyup blur",function(){var e=$(this);i(e,e.hasClass("ng-invalid"));e.hasClass("ng-invalid")?e.hasClass("ng-invalid-required")?s(e,"Your "+e.attr("id")+" is required"):e.hasClass("ng-invalid-minlength")?s(e,"Must be at least "+e.attr("ng-minlength")+" characters"):e.hasClass("ng-invalid-email")&&s(e,"Invalid email address"):e.hasClass("ng-valid")&&s(e,"Looks good!")});l.on("focus keyup",function(){t($(this))});u.on("focus keyup blur",function(){var r=$(this);i(r,e.password!==e.confPass);e.password!==e.confPass?s(r,"You passwords must match"):s(r,"We have a match!")})}]);angular.module("eventinator").factory("eventUser",["$resource",function(e){var r=e("/app/eventUsers/:id",{_id:"@id"},{update:{method:"PUT",isArray:!1}});return r}]);